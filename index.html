<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Prevent HTML caching - always fetch fresh version -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <title>ProjectMan</title>

    <!-- Preload critical CSS -->
    <link rel="preload" href="style.css?v=2.8" as="style">
    <link rel="stylesheet" href="style.css?v=2.8">
    <link rel="stylesheet" href="mobile-additions.css?v=2.8">

    <!-- Preconnect to external resources for faster loading -->
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://www.gstatic.com">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">

    <!-- Async load fonts - non-blocking -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"
        media="print" onload="this.media='all'">

    <!-- Async load icons - non-blocking -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        media="print" onload="this.media='all'">

    <!-- Inline critical CSS for loading indicator -->
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0f172a;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 1;
            transition: opacity 0.3s;
        }

        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(99, 102, 241, 0.3);
            border-top-color: #6366f1;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            color: rgba(255, 255, 255, 0.7);
            margin-top: 1rem;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 14px;
        }
    </style>

    <!-- Version checker - –û–¢–ö–õ–Æ–ß–ï–ù –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ -->
    <!-- <script src="version-check.js?v=1.9" defer></script> -->

    <!-- Scripts with defer for non-blocking loading -->
    <!-- Local Firebase Libraries for offline support and region independence -->
    <script src="libs/firebase-app.js" defer></script>
    <script src="libs/firebase-firestore.js" defer></script>
    <script src="libs/firebase-auth.js" defer></script>
    <!-- EmailJS –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º - –æ–Ω –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js" defer></script>
    <script src="script.js?v=2.9" defer></script>
</head>

<body>
    <!-- Loading Overlay with progress text -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
        <div class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...</div>
    </div>

    <!-- Auth Overlay -->
    <div id="auth-overlay" class="login-overlay">
        <!-- Registration/Login Screen -->
        <div id="auth-screen" class="login-card">
            <div class="brand" style="justify-content: center; margin-bottom: 1.5rem;">
                <i class="fa-solid fa-layer-group"></i> ProjectMan
            </div>
            <h2 id="auth-title">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            <p id="auth-subtitle" style="color: var(--text-secondary); margin-bottom: 2rem; text-align: center;">
                –í–æ–π–¥–∏—Ç–µ –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å
            </p>

            <!-- Login Form -->
            <form id="login-form" style="display: block; width: 100%;">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label for="login-password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="login-password" required placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                </div>
                <p id="login-error"
                    style="color: var(--danger); font-size: 0.85rem; margin-bottom: 1rem; display: none; text-align: left;">
                </p>
                <button type="submit" class="primary-btn"
                    style="width: 100%; justify-content: center; margin-bottom: 1rem;">–í–æ–π—Ç–∏</button>
                <p style="text-align: center; font-size: 0.9rem; color: var(--text-secondary);">
                    –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" id="show-register"
                        style="color: var(--primary); text-decoration: none; font-weight: 500;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
                </p>
            </form>

            <!-- Registration Form -->
            <form id="register-form" style="display: none; width: 100%;">
                <div class="form-row" style="gap: 1rem;">
                    <div class="form-group" style="flex: 1;">
                        <label for="register-first-name">–ò–º—è</label>
                        <input type="text" id="register-first-name" required placeholder="–ò–≤–∞–Ω">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label for="register-last-name">–§–∞–º–∏–ª–∏—è</label>
                        <input type="text" id="register-last-name" required placeholder="–ò–≤–∞–Ω–æ–≤">
                    </div>
                </div>
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label for="register-password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="register-password" required placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤">
                </div>
                <div class="form-group">
                    <label for="register-password-confirm">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="register-password-confirm" required placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                </div>
                <p id="register-error"
                    style="color: var(--danger); font-size: 0.85rem; margin-bottom: 1rem; display: none; text-align: left;">
                </p>
                <button type="submit" class="primary-btn"
                    style="width: 100%; justify-content: center; margin-bottom: 1rem;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <p style="text-align: center; font-size: 0.9rem; color: var(--text-secondary);">
                    –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" id="show-login"
                        style="color: var(--primary); text-decoration: none; font-weight: 500;">–í–æ–π—Ç–∏</a>
                </p>
            </form>
        </div>

        <!-- Role Selection Screen (Removed) -->
        
        <!-- Admin Password Verification Modal -->
        <div id="admin-verify-screen" class="login-card" style="display: none;">
            <div class="brand" style="justify-content: center; margin-bottom: 2rem;">
                <i class="fa-solid fa-shield-halved"></i>
            </div>
            <h2>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem; text-align: center;">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å
                –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</p>

            <div class="form-group">
                <label for="admin-verify-password">–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</label>
                <input type="password" id="admin-verify-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
                    style="margin-bottom: 1rem;">
            </div>
            <p id="admin-verify-error"
                style="color: var(--danger); font-size: 0.8rem; margin-bottom: 1rem; display: none;">–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å</p>
            <div style="display: flex; gap: 1rem;">
                <button id="admin-verify-cancel" class="secondary-btn"
                    style="flex: 1; justify-content: center;">–û—Ç–º–µ–Ω–∞</button>
                <button id="admin-verify-submit" class="primary-btn"
                    style="flex: 1; justify-content: center;">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="app-container">
        <aside class="sidebar">
            <div class="brand">
                <i class="fa-solid fa-layer-group"></i> ProjectMan
            </div>

            <div class="projects-header">
                <h3>–ü–†–û–ï–ö–¢–´</h3>
                <button id="add-project-btn" class="icon-btn" title="–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç">
                    <i class="fa-solid fa-plus"></i>
                </button>
            </div>

            <ul id="project-list" class="project-list">
                <!-- Projects will be injected here -->
            </ul>

            <div class="sidebar-footer"
                style="margin-top: auto; padding-top: 1rem; display: flex; flex-direction: column; gap: 0.5rem;">
                <button id="admin-panel-btn" class="secondary-btn"
                    style="width: 100%; justify-content: center; display: none;">
                    <i class="fa-solid fa-user-shield"></i> <span>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</span>
                </button>
                <button id="theme-toggle" class="secondary-btn" style="width: 100%; justify-content: center;">
                    <i class="fa-regular fa-sun"></i> <span>–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞</span>
                </button>
                <button id="logout-btn" class="danger-btn"
                    style="width: 100%; justify-content: center; background: rgba(239, 68, 68, 0.05);">
                    <i class="fa-solid fa-right-from-bracket"></i> <span>–í—ã–π—Ç–∏</span>
                </button>
            </div>
        </aside>

        <main class="main-content">
            <header class="top-bar">
                <button id="mobile-menu-btn" class="icon-btn" style="margin-right: 1rem; font-size: 1.2rem;">
                    <i class="fa-solid fa-bars"></i>
                </button>
                <div class="project-info" id="active-project-info">
                    <h1 id="project-title">–í—ã–±–µ—Ä–∏—Ç–µ –±–∏–∑–Ω–µ—Å</h1>
                    <p id="project-desc">–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É</p>
                </div>
                <div class="actions">
                    <button id="help-btn" class="secondary-btn" title="–ü–æ–º–æ—â—å">
                        <i class="fa-solid fa-circle-question"></i>
                    </button>
                    <button id="add-task-btn" class="primary-btn" disabled>
                        <i class="fa-solid fa-plus"></i> –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞
                    </button>
                    <button id="delete-project-btn" class="danger-btn" style="display: none;">
                        <i class="fa-solid fa-trash"></i>
                    </button>
                </div>
            </header>

            <div class="board-container" id="board-container">
                <!-- Kanban Columns -->
                <!-- Kanban Columns -->

                <div class="column" data-status="in-progress">
                    <div class="column-header">
                        <span class="status-indicator in-progress"></span>
                        <h2>–í –ø—Ä–æ—Ü–µ—Å—Å–µ</h2>
                        <span class="count" id="count-in-progress">0</span>
                    </div>
                    <div class="task-list" id="list-in-progress">
                        <!-- Tasks -->
                    </div>
                </div>

                <div class="column" data-status="done">
                    <div class="column-header">
                        <span class="status-indicator done"></span>
                        <h2>–ì–æ—Ç–æ–≤–æ</h2>
                        <span class="count" id="count-done">0</span>
                    </div>
                    <div class="task-list" id="list-done">
                        <!-- Tasks -->
                    </div>
                </div>
            </div>

            <div id="empty-state" class="empty-state">
                <i class="fa-solid fa-clipboard-list"></i>
                <p>–í—ã–±–µ—Ä–∏—Ç–µ –±–∏–∑–Ω–µ—Å —Å–ª–µ–≤–∞, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∑–∞–¥–∞—á–∏</p>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <div id="project-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</h2>
                <button class="close-modal"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <form id="project-form">
                <div class="form-group">
                    <label for="p-name">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" id="p-name" required placeholder="">
                </div>
                <div class="form-group">
                    <label for="p-desc">–û–ø–∏—Å–∞–Ω–∏–µ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</label>
                    <textarea id="p-desc" rows="3" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ..."></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="secondary-btn close-modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="primary-btn">–°–æ–∑–¥–∞—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <div id="task-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</h2>
                <button class="close-modal"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <form id="task-form">
                <div class="form-group">
                    <label for="t-title">–ó–∞–¥–∞—á–∞</label>
                    <input type="text" id="t-title" required placeholder="–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?">
                </div>

                <div class="form-group">
                    <label for="t-description">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / –û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="t-description" rows="3" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ</label>
                        <div id="t-assignee-container" class="multi-select-container">
                            <!-- Checkboxes will be injected here -->
                            <div style="padding: 0.5rem; color: var(--text-secondary);">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="t-deadline">–°—Ä–æ–∫</label>
                        <input type="date" id="t-deadline" required>
                    </div>
                </div>

                <!-- Status hidden, defaults to in-progress -->
                <input type="hidden" id="t-status" value="in-progress">
                <input type="hidden" id="t-id">
                <div class="modal-footer">
                    <button type="button" class="secondary-btn close-modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="primary-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal">
        <div class="modal-content help-modal-content">
            <div class="modal-header">
                <h2><i class="fa-solid fa-circle-question"></i> –ü–æ–º–æ—â—å</h2>
                <button class="close-modal"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="help-content">
                <div class="help-section">
                    <h3><i class="fa-solid fa-rocket"></i> –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã</h3>
                    <p>ProjectMan - —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ –¥–ª—è –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞.</p>
                    <ul>
                        <li><strong>–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç</strong> - –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "+" –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏</li>
                        <li><strong>–î–æ–±–∞–≤—å—Ç–µ –∑–∞–¥–∞—á–∏</strong> - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞"</li>
                        <li><strong>–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏</strong> - –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –∑–∞–¥–∞—á–∏ –º–µ–∂–¥—É –∫–æ–ª–æ–Ω–∫–∞–º–∏</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3><i class="fa-solid fa-users"></i> –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö</h3>
                    <p>–í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞ –∑–∞–¥–∞—á—É:</p>
                    <ul>
                        <li><strong>–û–¥–∏–Ω –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:</strong> –ø—Ä–æ—Å—Ç–æ –≤–≤–µ–¥–∏—Ç–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ê–Ω–Ω–∞")</li>
                        <li><strong>–ù–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö:</strong> —Ä–∞–∑–¥–µ–ª–∏—Ç–µ –∏–º–µ–Ω–∞ –∑–∞–ø—è—Ç–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ê–Ω–Ω–∞, –ü–µ—Ç—Ä")
                        </li>
                    </ul>
                    <p class="help-note">üí° –ö–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º –∞–≤–∞—Ç–∞—Ä–æ–º –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ
                        –∑–∞–¥–∞—á–∏.</p>
                </div>

                <div class="help-section">
                    <h3><i class="fa-solid fa-hand-pointer"></i> –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∑–∞–¥–∞—á</h3>
                    <p><strong>–ù–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:</strong></p>
                    <ul>
                        <li>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É –∑–∞–¥–∞—á–∏ –º—ã—à—å—é –≤ –Ω—É–∂–Ω—É—é –∫–æ–ª–æ–Ω–∫—É</li>
                        <li>–û—Ç–ø—É—Å—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å</li>
                    </ul>
                    <p><strong>–ù–∞ –º–æ–±–∏–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:</strong></p>
                    <ul>
                        <li>–ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É –∑–∞–¥–∞—á–∏</li>
                        <li>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ø–∞–ª—å—Ü–µ–º –≤ –∫–æ–ª–æ–Ω–∫—É "–í –ø—Ä–æ—Ü–µ—Å—Å–µ" –∏–ª–∏ "–ì–æ—Ç–æ–≤–æ"</li>
                        <li>–û—Ç–ø—É—Å—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3><i class="fa-solid fa-mobile-screen"></i> –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è</h3>
                    <ul>
                        <li>–ù–∞–∂–º–∏—Ç–µ <i class="fa-solid fa-bars"></i> –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é –ø—Ä–æ–µ–∫—Ç–æ–≤</li>
                        <li>–ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–π—Ç–µ –∫–æ–ª–æ–Ω–∫–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö –∑–∞–¥–∞—á</li>
                        <li>–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∫–∞–∫ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, —Ç–∞–∫ –∏ –¥–ª—è –≥–æ—Å—Ç—è</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3><i class="fa-solid fa-eye"></i> –†–µ–∂–∏–º –≥–æ—Å—Ç—è</h3>
                    <p>–í —Ä–µ–∂–∏–º–µ –≥–æ—Å—Ç—è –≤—ã –º–æ–∂–µ—Ç–µ:</p>
                    <ul>
                        <li>‚úÖ –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ–µ–∫—Ç—ã –∏ –∑–∞–¥–∞—á–∏</li>
                        <li>‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏</li>
                        <li>‚úÖ –í–∏–¥–µ—Ç—å –¥–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á</li>
                        <li>‚ùå –°–æ–∑–¥–∞–≤–∞—Ç—å, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —É–¥–∞–ª—è—Ç—å –∑–∞–¥–∞—á–∏ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="admin-panel-modal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2><i class="fa-solid fa-user-shield"></i> –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
                <button class="close-modal"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="admin-panel-content" style="padding: 1.5rem;">
                <div class="admin-tabs">
                    <button class="admin-tab active" data-tab="users">
                        <i class="fa-solid fa-users"></i> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
                    </button>
                    <button class="admin-tab" data-tab="access">
                        <i class="fa-solid fa-key"></i> –î–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–µ–∫—Ç–∞–º
                    </button>
                </div>

                <!-- Users Tab -->
                <div id="admin-users-tab" class="admin-tab-content active">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <h3 style="margin: 0;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                        <span id="users-count" style="color: var(--text-secondary); font-size: 0.9rem;">0
                            –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</span>
                    </div>
                    <div id="users-list" class="users-list">
                        <!-- Users will be loaded here -->
                    </div>
                </div>

                <!-- Project Access Tab -->
                <div id="admin-access-tab" class="admin-tab-content">
                    <div style="margin-bottom: 1.5rem;">
                        <h3 style="margin-bottom: 0.5rem;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ –ø—Ä–æ–µ–∫—Ç–∞–º</h3>
                        <p style="color: var(--text-secondary); font-size: 0.9rem;">
                            –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ, –∫–∞–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –æ–Ω –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å
                        </p>
                    </div>

                    <div class="form-group">
                        <label for="access-user-select">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</label>
                        <select id="access-user-select"
                            style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 8px; background: var(--bg-secondary); color: var(--text); font-size: 0.95rem;">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...</option>
                        </select>
                    </div>

                    <div id="user-access-info" style="display: none;">
                        <div
                            style="background: var(--bg-secondary); border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem;">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <div class="avatar" style="width: 48px; height: 48px; font-size: 1.2rem;"
                                    id="selected-user-avatar">AB</div>
                                <div>
                                    <h4 id="selected-user-name" style="margin: 0;">–ò–º—è –§–∞–º–∏–ª–∏—è</h4>
                                    <p id="selected-user-email"
                                        style="margin: 0; color: var(--text-secondary); font-size: 0.9rem;">
                                        email@example.com</p>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                <input type="checkbox" id="allow-all-projects" style="width: auto;">
                                <span>–î–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –ø—Ä–æ–µ–∫—Ç–∞–º</span>
                            </label>
                        </div>

                        <div id="project-selection" style="display: block;">
                            <label style="margin-bottom: 0.75rem; display: block; font-weight: 500;">–î–æ—Å—Ç—É–ø–Ω—ã–µ
                                –ø—Ä–æ–µ–∫—Ç—ã:</label>
                            <div id="projects-checkboxes" class="projects-checkboxes">
                                <!-- Project checkboxes will be loaded here -->
                            </div>
                        </div>

                        <button id="save-access-btn" class="primary-btn"
                            style="width: 100%; justify-content: center; margin-top: 1.5rem;">
                            <i class="fa-solid fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Inline Safety Script -->
    <script>
        // Failsafe: if the app doesn't load within 8 seconds, show error
        setTimeout(function () {
            var loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay && !loadingOverlay.classList.contains('hidden')) {
                // Only show if no other error is displayed
                if (!loadingOverlay.innerHTML.includes('–û—à–∏–±–∫–∞')) {
                    loadingOverlay.innerHTML = '<div style="color:white; text-align:center; font-family:sans-serif; padding:20px;">' +
                        '<h3>–î–æ–ª–≥–∞—è –∑–∞–≥—Ä—É–∑–∫–∞...</h3>' +
                        '<p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç.</p>' +
                        '<p>1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É</p>' +
                        '<p>2. –û—Ç–∫–ª—é—á–∏—Ç–µ –±–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫–∏ —Ä–µ–∫–ª–∞–º—ã</p>' +
                        '<p>3. –ï—Å–ª–∏ –Ω–µ –≥—Ä—É–∑–∏—Ç—Å—è - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ VPN</p>' +
                        '<button onclick="window.location.reload()" style="padding:10px 20px; margin-top:15px; cursor:pointer; background:white; border:none; border-radius:4px;">–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</button>' +
                        '</div>';
                }
            }
        }, 8000);
    </script>
</body>

</html>